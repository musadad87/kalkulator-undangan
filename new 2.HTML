async function saveToGoogleSheets(data) {
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxG6buvnjrvJfckGOIbBiBZfmqDn72riyxgJVaaJqqvX2wdJjG1XMMLBBsuKDnzwMrh0Q/exec';
  
  // Format data sesuai dengan kolom Google Sheets
  const sheetsData = {
    'Nama': data.nama,
    'Tanggal Lahir': data.tanggalLahir,
    'Alamat Lengkap': data.alamat,
    'Timestamp': data.timestamp
  };
  
  try {
    console.log('Mengirim data ke Google Sheets:', sheetsData);
    
    const response = await fetch(SCRIPT_URL, {
      method: 'POST',
      mode: 'no-cors', // Required for Google Apps Script
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(sheetsData)
    });
    
    // Note: no-cors mode means we can't read the response
    // but the data should still be sent to Google Sheets
    console.log('Data berhasil dikirim ke Google Sheets');
    return { success: true };
    
  } catch (error) {
    console.error('Error mengirim ke Google Sheets:', error);
    throw new Error('Gagal mengirim ke Google Sheets: ' + error.message);
  }
}